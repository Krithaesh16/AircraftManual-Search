{% extends "base.html" %}
{% block title %}Search PDFs{% endblock %}
{% block content %}
<form method="GET">
  <input type="text" name="q" placeholder="Enter keyword" value="{{ query }}">
  <button type="submit">Search</button>
</form>

{% if results %}
  <h2>Results</h2>
  {% for r in results %}
    <div class="result-item">
      <p><b>{{ r['title'] }}</b> ({{ r['filename'] }}, page {{ r['page'] }})</p>

      <!-- Your existing open link -->
      <p>
        <a href="/pdfs/{{ r['filename'] }}#page={{ r['page'] }}" target="_blank">
          ğŸ“‚ Open PDF
        </a>
      </p>

      <!-- New: Open with PDF.js viewer and highlight the search term -->
      <p>
        <a
          href="{{ url_for('static', filename='pdfjs/web/viewer.html') }}?file={{ url_for('serve_pdf', filename=r['filename']) | urlencode }}#page={{ r['page'] }}&search={{ query | urlencode }}"
          target="_blank">
          ğŸ” Open PDF (highlight â€œ{{ query }}â€)
        </a>
      </p>

    </div>
  {% endfor %}
{% endif %}
{% endblock %}



